"use strict";(self.webpackChunkez_theme=self.webpackChunkez_theme||[]).push([[556],{16034:(e,t,a)=>{var r=a(46518),l=a(32357).values;r({target:"Object",stat:!0},{values:function(e){return l(e)}})},32124:(e,t,a)=>{a.d(t,{CR:()=>o,fU:()=>l,oL:()=>r});a(51629),a(59089),a(18111),a(7588),a(79432),a(26099),a(23500),a(76031);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach(function(t){e[t]&&(e[t]._repeat?clearInterval(e[t]):clearTimeout(e[t]),e[t]=null)}),Object.keys(t).forEach(function(e){var a=t[e];a&&a.element&&a.event&&a.callback&&(a.element.removeEventListener(a.event,a.callback,a.options),t[e]=null)})}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,a=null;return function(){for(var r=arguments.length,l=new Array(r),o=0;o<r;o++)l[o]=arguments[o];var n=this;return a&&clearTimeout(a),a=setTimeout(function(){e.apply(n,l),a=null},t)}}function o(e,t,a,r){var l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];e[t]&&(e[t]._repeat?clearInterval(e[t]):clearTimeout(e[t]),e[t]=null);var o=l?setInterval(a,r):setTimeout(a,r);return e[t]=o,o}},32357:(e,t,a)=>{var r=a(43724),l=a(79039),o=a(79504),n=a(42787),c=a(71072),i=a(25397),u=o(a(48773).f),s=o([].push),d=r&&l(function(){var e=Object.create(null);return e[2]=2,!u(e,2)}),f=function(e){return function(t){for(var a,l=i(t),o=c(l),f=d&&null===n(l),v=o.length,m=0,L=[];v>m;)a=o[m++],r&&!(f?a in l:u(l,a))||s(L,e?[a,l[a]]:l[a]);return L}};e.exports={entries:f(!0),values:f(!1)}},34556:(e,t,a)=>{a.r(t),a.d(t,{default:()=>N});var r=a(20908),l=a(59258),o=a(30388),n=(a(28706),a(2008),a(51629),a(74423),a(62062),a(44114),a(94490),a(34782),a(26910),a(23288),a(62010),a(18111),a(22489),a(7588),a(61701),a(9868),a(26099),a(16034),a(78459),a(31415),a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698),a(21699),a(47764),a(42762),a(23500),a(62953),a(76031),a(20641)),c=a(90033),i=a(50953),u=a(46992),s=a(98120),d=a(99507),f=a(49586),v=a(80394),m=a(64149),L=a(32124),p={class:"trafficlog-container"},g={class:"trafficlog-inner"},y={class:"dashboard-card welcome-card"},k={class:"card-header"},h={class:"card-title"},_={class:"card-body"},b={class:"formula-card"},C={class:"formula-title"},T={class:"formula-content"},F={class:"dashboard-card chart-card"},E={class:"card-header"},w={class:"card-title"},S={key:0,class:"chart-toggle-buttons"},R={class:""},x={class:""},$={class:"card-body"},O={key:0,class:"loading-container"},A={key:1,class:"error-container"},G={key:2,class:"empty-container"},I={class:"dashboard-card"},z={class:"card-header"},X={class:"card-title"},V={class:"card-body"},D={key:0,class:"loading-container"},P={key:1,class:"error-container"},Y={key:2,class:"empty-container"},M={key:3,class:"traffic-table-container"},B={class:"traffic-table"};const K={__name:"TrafficLog",setup:function(e){var t=(0,u.s9)().t,a=(0,i.KR)([]),K=(0,i.KR)(!0),N=(0,i.KR)(!1),j=(0,i.KR)(null),U=null,q=(0,i.KR)(!1),Q=function(){var e=(0,o.A)((0,r.A)().m(function e(){var t,o,n;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:return K.value=!0,N.value=!1,e.p=1,e.n=2,(0,d.a)();case 2:(t=e.v)&&t.data?(a.value=t.data.sort(function(e,t){return t.record_at-e.record_at}),v.TRAFFICLOG_CONFIG.daysToShow>0&&(o=(0,l.A)(new Set(a.value.map(function(e){var t=new Date(1e3*e.record_at);return"".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate())})))).length>v.TRAFFICLOG_CONFIG.daysToShow&&(n=o.slice(0,v.TRAFFICLOG_CONFIG.daysToShow),a.value=a.value.filter(function(e){var t=new Date(1e3*e.record_at),a="".concat(t.getFullYear(),"-").concat(t.getMonth()+1,"-").concat(t.getDate());return n.includes(a)}))):a.value=[],e.n=4;break;case 3:e.p=3,e.v,N.value=!0;case 4:return e.p=4,K.value=!1,e.f(4);case 5:return e.a(2)}},e,null,[[1,3,4,5]])}));return function(){return e.apply(this,arguments)}}(),H=function(e){q.value=e,J()},J=function(){if(U&&U.dispose(),j.value&&0!==a.value.length){U=m.Ts(j.value);var e,r=getComputedStyle(document.documentElement).getPropertyValue("--theme-color").trim()||"#355cc2",o=[],n=[],c=[],i=[];if(v.TRAFFICLOG_CONFIG.sumDailyTraffic){var u={};a.value.forEach(function(e){var t=e.record_at;u[t]||(u[t]={record_at:t,u:0,d:0}),q.value?(u[t].u+=e.u,u[t].d+=e.d):(u[t].u+=e.u*parseFloat(e.server_rate),u[t].d+=e.d*parseFloat(e.server_rate))}),e=Object.values(u).slice(0,30)}else e=(0,l.A)(a.value).slice(0,30).reverse();e.forEach(function(e){o.push((0,f.Yq)(e.record_at));var t=parseFloat((e.u/1073741824).toFixed(2)),a=parseFloat((e.d/1073741824).toFixed(2));n.push(t),c.push(a),i.push(parseFloat((t+a).toFixed(2)))});var s={tooltip:{trigger:"axis",formatter:function(e){var t=e[0].name+"<br/>";return e.forEach(function(e){var a=e.value+" GB";t+=e.marker+" "+e.seriesName+": "+a+"<br/>"}),t}},legend:{data:[t("trafficLog.uploadTraffic"),t("trafficLog.downloadTraffic"),t("trafficLog.totalTraffic")],bottom:0,textStyle:{color:getComputedStyle(document.documentElement).getPropertyValue("--text-color").trim()||"#333333"}},grid:{left:"3%",right:"4%",bottom:"60px",top:"30px",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:o,axisLabel:{rotate:45,interval:"auto",color:getComputedStyle(document.documentElement).getPropertyValue("--text-color").trim()||"#333333"},axisLine:{lineStyle:{color:getComputedStyle(document.documentElement).getPropertyValue("--border-color").trim()||"#e8e8e8"}},splitLine:{lineStyle:{color:getComputedStyle(document.documentElement).getPropertyValue("--border-color").trim()||"#e8e8e8"}}},yAxis:{type:"value",name:"GB",nameTextStyle:{padding:[0,0,0,10],color:getComputedStyle(document.documentElement).getPropertyValue("--text-color").trim()||"#333333"},axisLabel:{formatter:"{value} GB",color:getComputedStyle(document.documentElement).getPropertyValue("--text-color").trim()||"#333333"},axisLine:{lineStyle:{color:getComputedStyle(document.documentElement).getPropertyValue("--border-color").trim()||"#e8e8e8"}},splitLine:{lineStyle:{color:getComputedStyle(document.documentElement).getPropertyValue("--border-color").trim()||"#e8e8e8"}}},series:[{name:t("trafficLog.uploadTraffic"),type:"line",stack:"Total",smooth:!0,lineStyle:{width:2},showSymbol:!1,areaStyle:{opacity:.2},emphasis:{focus:"series"},data:n,color:"#36AD47"},{name:t("trafficLog.downloadTraffic"),type:"line",stack:"Total",smooth:!0,lineStyle:{width:2},showSymbol:!1,areaStyle:{opacity:.2},emphasis:{focus:"series"},data:c,color:"#4080FF"},{name:t("trafficLog.totalTraffic"),type:"line",smooth:!0,lineStyle:{width:3},showSymbol:!1,emphasis:{focus:"series"},data:i,color:r}]};U.setOption(s),window.addEventListener("resize",W)}},W=function(){U&&U.resize()},Z=(0,L.fU)(W,200);(0,n.wB)(a,function(){!K.value&&!N.value&&a.value.length>0&&(0,n.dY)(function(){J()})},{deep:!0});var ee=null,te=!0;return(0,n.sV)(function(){Q(),function(){ee&&ee.disconnect();var e=null;(ee=new MutationObserver(function(){te||(clearTimeout(e),e=setTimeout(function(){(0,n.dY)(function(){U&&j.value&&J()})},300))})).observe(document.documentElement,{attributes:!0,attributeFilter:["class","style"]}),setTimeout(function(){te=!1},800)}(),window.addEventListener("resize",Z)}),(0,n.hi)(function(){U&&(U.dispose(),U=null),window.removeEventListener("resize",Z),ee&&(ee.disconnect(),ee=null)}),function(e,t){return(0,n.uX)(),(0,n.CE)("div",p,[(0,n.Lk)("div",g,[(0,n.Lk)("div",y,[(0,n.Lk)("div",k,[(0,n.Lk)("h2",h,(0,c.v_)(e.$t("trafficLog.title")),1)]),(0,n.Lk)("div",_,[(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.description")),1),(0,n.Lk)("div",b,[(0,n.Lk)("div",C,(0,c.v_)(e.$t("trafficLog.formula"))+":",1),(0,n.Lk)("div",T,(0,c.v_)(e.$t("trafficLog.formulaContent")),1)])])]),(0,n.Lk)("div",F,[(0,n.Lk)("div",E,[(0,n.Lk)("h2",w,(0,c.v_)(e.$t("trafficLog.trafficChart")),1),(0,i.R1)(v.TRAFFICLOG_CONFIG).sumDailyTraffic?((0,n.uX)(),(0,n.CE)("div",S,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=function(e){return H(!1)}),class:(0,c.C4)({active:!q.value})},[(0,n.Lk)("span",R,(0,c.v_)(e.$t("trafficLog.deductedTraffic")),1)],2),(0,n.Lk)("button",{onClick:t[1]||(t[1]=function(e){return H(!0)}),class:(0,c.C4)({active:q.value})},[(0,n.Lk)("span",x,(0,c.v_)(e.$t("trafficLog.actualTraffic")),1)],2)])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",$,[K.value?((0,n.uX)(),(0,n.CE)("div",O,[t[2]||(t[2]=(0,n.Lk)("div",{class:"loading-spinner"},null,-1)),(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.loadingTraffic")),1)])):N.value?((0,n.uX)(),(0,n.CE)("div",A,[(0,n.bF)((0,i.R1)(s.GBC),{size:48,class:"error-icon"}),(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.errorLoadingTraffic")),1)])):a.value.length?((0,n.uX)(),(0,n.CE)("div",{key:3,ref_key:"chartRef",ref:j,class:"traffic-chart"},null,512)):((0,n.uX)(),(0,n.CE)("div",G,[(0,n.bF)((0,i.R1)(s.vUY),{size:48,class:"empty-icon"}),(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.noTrafficData")),1)]))])]),(0,n.Lk)("div",I,[(0,n.Lk)("div",z,[(0,n.Lk)("h2",X,(0,c.v_)(e.$t("trafficLog.title")),1)]),(0,n.Lk)("div",V,[K.value?((0,n.uX)(),(0,n.CE)("div",D,[t[3]||(t[3]=(0,n.Lk)("div",{class:"loading-spinner"},null,-1)),(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.loadingTraffic")),1)])):N.value?((0,n.uX)(),(0,n.CE)("div",P,[(0,n.bF)((0,i.R1)(s.GBC),{size:48,class:"error-icon"}),(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.errorLoadingTraffic")),1),(0,n.Lk)("button",{class:"retry-button",onClick:Q},(0,c.v_)(e.$t("trafficLog.retry")),1)])):a.value.length?((0,n.uX)(),(0,n.CE)("div",M,[(0,n.Lk)("table",B,[(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[(0,n.Lk)("th",null,(0,c.v_)(e.$t("trafficLog.date")),1),(0,n.Lk)("th",null,(0,c.v_)(e.$t("trafficLog.uploadTraffic")),1),(0,n.Lk)("th",null,(0,c.v_)(e.$t("trafficLog.downloadTraffic")),1),(0,n.Lk)("th",null,(0,c.v_)(e.$t("trafficLog.totalTraffic")),1),(0,n.Lk)("th",null,(0,c.v_)(e.$t("trafficLog.serverRate")),1),(0,n.Lk)("th",null,(0,c.v_)(e.$t("trafficLog.deductedTraffic")),1)])]),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.value,function(e,t){return(0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("td",null,(0,c.v_)((0,i.R1)(f.Yq)(e.record_at)),1),(0,n.Lk)("td",null,(0,c.v_)((0,i.R1)(f.zM)(e.u)),1),(0,n.Lk)("td",null,(0,c.v_)((0,i.R1)(f.zM)(e.d)),1),(0,n.Lk)("td",null,(0,c.v_)((0,i.R1)(f.zM)(e.u+e.d)),1),(0,n.Lk)("td",null,(0,c.v_)(e.server_rate)+"x",1),(0,n.Lk)("td",null,(0,c.v_)((0,i.R1)(f.zM)((e.u+e.d)*parseFloat(e.server_rate))),1)])}),128))])])])):((0,n.uX)(),(0,n.CE)("div",Y,[(0,n.bF)((0,i.R1)(s.vUY),{size:48,class:"empty-icon"}),(0,n.Lk)("p",null,(0,c.v_)(e.$t("trafficLog.noTrafficData")),1)]))])])])])}}};const N=(0,a(66262).A)(K,[["__scopeId","data-v-a785b822"]])},99507:(e,t,a)=>{a.d(t,{a:()=>l});var r=a(96131);function l(){return(0,r.A)({url:"/user/stat/getTrafficLog",method:"get"})}}}]);